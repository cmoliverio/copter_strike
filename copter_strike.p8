pico-8 cartridge // http://www.pico-8.com
version 33
__lua__

p={
 sprite = 3,
 sprite_force = 0.3,
 facing_left = false,
 x = 64,
 y = 64,
 dx = 0,
 dy = 0,
 dx_force = 0.04,
 dy_force = 0.04,
 air_resistance = 0.03,
 dx_max = 1,
 dy_max = 1,
 angle = 0,
 angle_force = 5,
 angle_relax = 2,
 max_tilt = 60
}

function _init()
 cls()
 tick = 0
end

function _draw()
 cls()
 cursor(0,0)

 local rotor_color = (tick % 4 == 0 and 7 or 0)

 -- make pink drawn as white for helicopter
 pal(14, rotor_color)
 rspr(p.sprite, p.x, p.y, p.angle % 360, 1, 1)
 pal(14, 14) -- set pink back to pink

end

function move_helicopter()

 -- angle turning left
 if btn(0) and not btn(1)
 then
  facing_left = true
  p.angle = max(p.angle - p.angle_force, p.max_tilt * -1)
  p.sprite = max(p.sprite - p.sprite_force, 1)
  p.dx = max(p.dx - p.dx_force, p.dx_max * -1)
 end
 -- angle turning right
 if btn(1) and not btn(0)
 then
  facing_left = false
  p.angle = min(p.angle + p.angle_force, p.max_tilt)
  p.sprite = min(p.sprite + p.sprite_force, 5)
  p.dx = min(p.dx + p.dx_force, p.dx_max)
 end

 -- allows moonwalk to the left
 if btn(1) and btn(0) and facing_left
 then
  p.angle = max(p.angle - p.angle_force, p.max_tilt * -1 / 2)
  p.sprite = min(p.sprite + p.sprite_force, 5)
 end
 -- allows moonwalk to the right
 if btn(0) and btn(1) and not facing_left
 then
  p.angle = min(p.angle + p.angle_force, p.max_tilt / 2)
  p.sprite = max(p.sprite - p.sprite_force, 1)
 end
 -- the above moonwalk sections also conveniently allow
 -- double moonwalking, slow movement in original direction

 -- slow down our movement left and right when not moving
 if not btn(1) and not btn(0)
 then
  p.dx = p.dx > 0 and max(p.dx - p.air_resistance, 0) or min(p.dx + p.air_resistance, 0)
  p.angle = p.angle > 0 and max(p.angle - p.angle_relax, 0) or min(p.angle + p.angle_relax, 0)
 end

 -- when moving upwards
 if btn(2)
 then
  p.dy = max(p.dy - p.dy_force, p.dy_max * -1)
 end

  -- when moving downwards
 if btn(3)
 then
  p.dy = min(p.dy + p.dy_force, p.dy_max)
 end

  -- not moving up or down
 if not btn(3) and not btn(2)
 then
  p.dy = p.dy > 0 and max(p.dy - p.air_resistance, 0) or min(p.dy + p.air_resistance, 0)
 end

 p.x += p.dx
 p.y += p.dy

end

function _update60()
 tick = tick + 1

 move_helicopter()


end

function wait(a) for i = 1,a do flip() end end

-- taken from warrior_of_cayuse
function rspr(s, x, y, deg, w, h)
  local sw, sh, sx, sy = (w or 1) * 8, (h or 1) * 8, flr(s%16) * 8, flr(s / 16) * 8
  local x0, y0, a = flr(0.5 * sw),
  flr(0.5 * sh),
  deg / 360

  local sa, ca = sin(a), cos(a)

  for ix = sw * - 1, sw + 4 do -- -8 > 12
    for iy = sh * - 1, sh + 4 do -- -8 > 12
      local dx, dy = ix - x0, iy - y0
      local xx, yy = flr(dx * ca - dy * sa + x0), flr(dx * sa + dy * ca + y0)
      if (xx >= 0 and xx < sw and yy >= 0 and yy <= sh - 1) then
        local col = sget(sx + xx, sy + yy)
        if col ~= 0 then
          local ax = 0
          if a > 0 then ax = 1 end
          pset(x + ix - ax, y + iy, col)
        end
      end
    end
  end
end

__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000eee77eeeeee77eeeeee77eeeeee77eeeeee77eee00000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000cc000200cc0080000cc0000800cc002000cc0000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000cc88d8e0ccc88e0008cc8000e88ccc0e8288cc000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000882200d088820d0002882000d028880d002288000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000dd00000d00d0000d0000d0000d00d00000dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000d0d5d56600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000d0d5d56600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000d0d5d55600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000005555d500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000005555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000066655555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000005555566666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000555066ccccc6000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000d0d5d5666ccccccc600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000d0d5d5666ccccccc600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000d0d5d55666ccccc6000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000005555d566666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000005555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000066655550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000005555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
77707770777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700070707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77700070707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000070707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77700070777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000006600000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000006cc60000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000006cccc6000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000006cccc6000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000006cccc6000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000056cccc6500000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000056cccc6500000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000566cc66500000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000055666666550000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000555566665555000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000005555d5665d555500000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000055555555555555550000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000055655dddd5565500000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000565555555565000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000605dddd5060000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000dddd0000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
